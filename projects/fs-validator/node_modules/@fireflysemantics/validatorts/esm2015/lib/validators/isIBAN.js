import { assertString } from '../util/assertString';
/**
 * List of country codes with
 * corresponding IBAN regular expression
 * Reference: https://en.wikipedia.org/wiki/International_Bank_Account_Number
 */
const ibanRegexThroughCountryCode = {
    AD: /^(AD[0-9]{2})\d{8}[A-Z0-9]{12}$/,
    AE: /^(AE[0-9]{2})\d{3}\d{16}$/,
    AL: /^(AL[0-9]{2})\d{8}[A-Z0-9]{16}$/,
    AT: /^(AT[0-9]{2})\d{16}$/,
    AZ: /^(AZ[0-9]{2})[A-Z0-9]{4}\d{20}$/,
    BA: /^(BA[0-9]{2})\d{16}$/,
    BE: /^(BE[0-9]{2})\d{12}$/,
    BG: /^(BG[0-9]{2})[A-Z]{4}\d{6}[A-Z0-9]{8}$/,
    BH: /^(BH[0-9]{2})[A-Z]{4}[A-Z0-9]{14}$/,
    BR: /^(BR[0-9]{2})\d{23}[A-Z]{1}[A-Z0-9]{1}$/,
    BY: /^(BY[0-9]{2})[A-Z0-9]{4}\d{20}$/,
    CH: /^(CH[0-9]{2})\d{5}[A-Z0-9]{12}$/,
    CR: /^(CR[0-9]{2})\d{18}$/,
    CY: /^(CY[0-9]{2})\d{8}[A-Z0-9]{16}$/,
    CZ: /^(CZ[0-9]{2})\d{20}$/,
    DE: /^(DE[0-9]{2})\d{18}$/,
    DK: /^(DK[0-9]{2})\d{14}$/,
    DO: /^(DO[0-9]{2})[A-Z]{4}\d{20}$/,
    EE: /^(EE[0-9]{2})\d{16}$/,
    ES: /^(ES[0-9]{2})\d{20}$/,
    FI: /^(FI[0-9]{2})\d{14}$/,
    FO: /^(FO[0-9]{2})\d{14}$/,
    FR: /^(FR[0-9]{2})\d{10}[A-Z0-9]{11}\d{2}$/,
    GB: /^(GB[0-9]{2})[A-Z]{4}\d{14}$/,
    GE: /^(GE[0-9]{2})[A-Z0-9]{2}\d{16}$/,
    GI: /^(GI[0-9]{2})[A-Z]{4}[A-Z0-9]{15}$/,
    GL: /^(GL[0-9]{2})\d{14}$/,
    GR: /^(GR[0-9]{2})\d{7}[A-Z0-9]{16}$/,
    GT: /^(GT[0-9]{2})[A-Z0-9]{4}[A-Z0-9]{20}$/,
    HR: /^(HR[0-9]{2})\d{17}$/,
    HU: /^(HU[0-9]{2})\d{24}$/,
    IE: /^(IE[0-9]{2})[A-Z0-9]{4}\d{14}$/,
    IL: /^(IL[0-9]{2})\d{19}$/,
    IQ: /^(IQ[0-9]{2})[A-Z]{4}\d{15}$/,
    IS: /^(IS[0-9]{2})\d{22}$/,
    IT: /^(IT[0-9]{2})[A-Z]{1}\d{10}[A-Z0-9]{12}$/,
    JO: /^(JO[0-9]{2})[A-Z]{4}\d{22}$/,
    KW: /^(KW[0-9]{2})[A-Z]{4}[A-Z0-9]{22}$/,
    KZ: /^(KZ[0-9]{2})\d{3}[A-Z0-9]{13}$/,
    LB: /^(LB[0-9]{2})\d{4}[A-Z0-9]{20}$/,
    LC: /^(LC[0-9]{2})[A-Z]{4}[A-Z0-9]{24}$/,
    LI: /^(LI[0-9]{2})\d{5}[A-Z0-9]{12}$/,
    LT: /^(LT[0-9]{2})\d{16}$/,
    LU: /^(LU[0-9]{2})\d{3}[A-Z0-9]{13}$/,
    LV: /^(LV[0-9]{2})[A-Z]{4}[A-Z0-9]{13}$/,
    MC: /^(MC[0-9]{2})\d{10}[A-Z0-9]{11}\d{2}$/,
    MD: /^(MD[0-9]{2})[A-Z0-9]{20}$/,
    ME: /^(ME[0-9]{2})\d{18}$/,
    MK: /^(MK[0-9]{2})\d{3}[A-Z0-9]{10}\d{2}$/,
    MR: /^(MR[0-9]{2})\d{23}$/,
    MT: /^(MT[0-9]{2})[A-Z]{4}\d{5}[A-Z0-9]{18}$/,
    MU: /^(MU[0-9]{2})[A-Z]{4}\d{19}[A-Z]{3}$/,
    NL: /^(NL[0-9]{2})[A-Z]{4}\d{10}$/,
    NO: /^(NO[0-9]{2})\d{11}$/,
    PK: /^(PK[0-9]{2})[A-Z0-9]{4}\d{16}$/,
    PL: /^(PL[0-9]{2})\d{24}$/,
    PS: /^(PS[0-9]{2})[A-Z0-9]{4}\d{21}$/,
    PT: /^(PT[0-9]{2})\d{21}$/,
    QA: /^(QA[0-9]{2})[A-Z]{4}[A-Z0-9]{21}$/,
    RO: /^(RO[0-9]{2})[A-Z]{4}[A-Z0-9]{16}$/,
    RS: /^(RS[0-9]{2})\d{18}$/,
    SA: /^(SA[0-9]{2})\d{2}[A-Z0-9]{18}$/,
    SC: /^(SC[0-9]{2})[A-Z]{4}\d{20}[A-Z]{3}$/,
    SE: /^(SE[0-9]{2})\d{20}$/,
    SI: /^(SI[0-9]{2})\d{15}$/,
    SK: /^(SK[0-9]{2})\d{20}$/,
    SM: /^(SM[0-9]{2})[A-Z]{1}\d{10}[A-Z0-9]{12}$/,
    TL: /^(TL[0-9]{2})\d{19}$/,
    TN: /^(TN[0-9]{2})\d{20}$/,
    TR: /^(TR[0-9]{2})\d{5}[A-Z0-9]{17}$/,
    UA: /^(UA[0-9]{2})\d{6}[A-Z0-9]{19}$/,
    VA: /^(VA[0-9]{2})\d{18}$/,
    VG: /^(VG[0-9]{2})[A-Z0-9]{4}\d{16}$/,
    XK: /^(XK[0-9]{2})\d{16}$/,
};
/**
 * Check whether string has correct universal IBAN format
 * The IBAN consists of up to 34 alphanumeric characters, as follows:
 * Country Code using ISO 3166-1 alpha-2, two letters
 * check digits, two digits and
 * Basic Bank Account Number (BBAN), up to 30 alphanumeric characters.
 * NOTE: Permitted IBAN characters are: digits [0-9] and the 26 latin alphabetic [A-Z]
 *
 * @param {string} str - string under validation
 * @return {boolean}
 */
function hasValidIbanFormat(str) {
    // Strip white spaces and hyphens, keep only digits and A-Z latin alphabetic
    const strippedStr = str.replace(/[^A-Z0-9]+/gi, '').toUpperCase();
    const isoCountryCode = strippedStr.slice(0, 2).toUpperCase();
    return (isoCountryCode in ibanRegexThroughCountryCode) &&
        ibanRegexThroughCountryCode[isoCountryCode].test(strippedStr);
}
/**
   * Check whether string has valid IBAN Checksum
   * by performing basic mod-97 operation and
   * the remainder should equal 1
   * -- Start by rearranging the IBAN by moving the four initial characters to the end of the string
   * -- Replace each letter in the string with two digits, A -> 10, B = 11, Z = 35
   * -- Interpret the string as a decimal integer and
   * -- compute the remainder on division by 97 (mod 97)
   * Reference: https://en.wikipedia.org/wiki/International_Bank_Account_Number
   *
   * @param target The target string
   * @return true if the string has a valid IBAN checksum, false otherwise
   */
function hasValidIbanChecksum(target) {
    const strippedStr = target.replace(/[^A-Z0-9]+/gi, '').toUpperCase(); // Keep only digits and A-Z latin alphabetic
    const rearranged = strippedStr.slice(4) + strippedStr.slice(0, 4);
    const alphaCapsReplacedWithDigits = rearranged.replace(/[A-Z]/g, char => char.charCodeAt(0) - 55);
    const remainder = alphaCapsReplacedWithDigits.match(/\d{1,7}/g)
        .reduce((acc, value) => Number(acc + value) % 97, '');
    return remainder === 1;
}
/**
 * Checks whether the IBAN number has a valid format and checksum.
 *
 * @param target The target string
 * @return true if the target has a valid format and checksum, false otherwise
 */
export function isIBAN(target) {
    assertString(target);
    return hasValidIbanFormat(target) && hasValidIbanChecksum(target);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXNJQkFOLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZpcmVmbHlzZW1hbnRpY3MvdmFsaWRhdG9ydHMvIiwic291cmNlcyI6WyJsaWIvdmFsaWRhdG9ycy9pc0lCQU4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRXBEOzs7O0dBSUc7QUFDSCxNQUFNLDJCQUEyQixHQUFHO0lBQ2xDLEVBQUUsRUFBRSxpQ0FBaUM7SUFDckMsRUFBRSxFQUFFLDJCQUEyQjtJQUMvQixFQUFFLEVBQUUsaUNBQWlDO0lBQ3JDLEVBQUUsRUFBRSxzQkFBc0I7SUFDMUIsRUFBRSxFQUFFLGlDQUFpQztJQUNyQyxFQUFFLEVBQUUsc0JBQXNCO0lBQzFCLEVBQUUsRUFBRSxzQkFBc0I7SUFDMUIsRUFBRSxFQUFFLHdDQUF3QztJQUM1QyxFQUFFLEVBQUUsb0NBQW9DO0lBQ3hDLEVBQUUsRUFBRSx5Q0FBeUM7SUFDN0MsRUFBRSxFQUFFLGlDQUFpQztJQUNyQyxFQUFFLEVBQUUsaUNBQWlDO0lBQ3JDLEVBQUUsRUFBRSxzQkFBc0I7SUFDMUIsRUFBRSxFQUFFLGlDQUFpQztJQUNyQyxFQUFFLEVBQUUsc0JBQXNCO0lBQzFCLEVBQUUsRUFBRSxzQkFBc0I7SUFDMUIsRUFBRSxFQUFFLHNCQUFzQjtJQUMxQixFQUFFLEVBQUUsOEJBQThCO0lBQ2xDLEVBQUUsRUFBRSxzQkFBc0I7SUFDMUIsRUFBRSxFQUFFLHNCQUFzQjtJQUMxQixFQUFFLEVBQUUsc0JBQXNCO0lBQzFCLEVBQUUsRUFBRSxzQkFBc0I7SUFDMUIsRUFBRSxFQUFFLHVDQUF1QztJQUMzQyxFQUFFLEVBQUUsOEJBQThCO0lBQ2xDLEVBQUUsRUFBRSxpQ0FBaUM7SUFDckMsRUFBRSxFQUFFLG9DQUFvQztJQUN4QyxFQUFFLEVBQUUsc0JBQXNCO0lBQzFCLEVBQUUsRUFBRSxpQ0FBaUM7SUFDckMsRUFBRSxFQUFFLHVDQUF1QztJQUMzQyxFQUFF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QUMsR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFFeEQsT0FBTyxTQUFTLEtBQUssQ0FBQyxDQUFDO0FBQ3pCLENBQUM7QUFDRDs7Ozs7R0FLRztBQUNILE1BQU0sVUFBVSxNQUFNLENBQUMsTUFBYztJQUNuQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFckIsT0FBTyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsSUFBSSxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNwRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXNzZXJ0U3RyaW5nIH0gZnJvbSAnLi4vdXRpbC9hc3NlcnRTdHJpbmcnO1xuXG4vKipcbiAqIExpc3Qgb2YgY291bnRyeSBjb2RlcyB3aXRoXG4gKiBjb3JyZXNwb25kaW5nIElCQU4gcmVndWxhciBleHByZXNzaW9uXG4gKiBSZWZlcmVuY2U6IGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0ludGVybmF0aW9uYWxfQmFua19BY2NvdW50X051bWJlclxuICovXG5jb25zdCBpYmFuUmVnZXhUaHJvdWdoQ291bnRyeUNvZGUgPSB7XG4gIEFEOiAvXihBRFswLTldezJ9KVxcZHs4fVtBLVowLTldezEyfSQvLFxuICBBRTogL14oQUVbMC05XXsyfSlcXGR7M31cXGR7MTZ9JC8sXG4gIEFMOiAvXihBTFswLTldezJ9KVxcZHs4fVtBLVowLTldezE2fSQvLFxuICBBVDogL14oQVRbMC05XXsyfSlcXGR7MTZ9JC8sXG4gIEFaOiAvXihBWlswLTldezJ9KVtBLVowLTldezR9XFxkezIwfSQvLFxuICBCQTogL14oQkFbMC05XXsyfSlcXGR7MTZ9JC8sXG4gIEJFOiAvXihCRVswLTldezJ9KVxcZHsxMn0kLyxcbiAgQkc6IC9eKEJHWzAtOV17Mn0pW0EtWl17NH1cXGR7Nn1bQS1aMC05XXs4fSQvLFxuICBCSDogL14oQkhbMC05XXsyfSlbQS1aXXs0fVtBLVowLTldezE0fSQvLFxuICBCUjogL14oQlJbMC05XXsyfSlcXGR7MjN9W0EtWl17MX1bQS1aMC05XXsxfSQvLFxuICBCWTogL14oQllbMC05XXsyfSlbQS1aMC05XXs0fVxcZHsyMH0kLyxcbiAgQ0g6IC9eKENIWzAtOV17Mn0pXFxkezV9W0EtWjAtOV17MTJ9JC8sXG4gIENSOiAvXihDUlswLTldezJ9KVxcZHsxOH0kLyxcbiAgQ1k6IC9eKENZWzAtOV17Mn0pXFxkezh9W0EtWjAtOV17MTZ9JC8sXG4gIENaOiAvXihDWlswLTldezJ9KVxcZHsyMH0kLyxcbiAgREU6IC9eKERFWzAtOV17Mn0pXFxkezE4fSQvLFxuICBESzogL14oREtbMC05XXsyfSlcXGR7MTR9JC8sXG4gIERPOiAvXihET1swLTldezJ9KVtBLVpdezR9XFxkezIwfSQvLFxuICBFRTogL14oRUVbMC05XXsyfSlcXGR7MTZ9JC8sXG4gIEVTOiAvXihFU1swLTldezJ9KVxcZHsyMH0kLyxcbiAgRkk6IC9eKEZJWzAtOV17Mn0pXFxkezE0fSQvLFxuICBGTzogL14oRk9bMC05XXsyfSlcXGR7MTR9JC8sXG4gIEZSOiAvXihGUlswLTldezJ9KVxcZHsxMH1bQS1aMC05XXsxMX1cXGR7Mn0kLyxcbiAgR0I6IC9eKEdCWzAtOV17Mn0pW0EtWl17NH1cXGR7MTR9JC8sXG4gIEdFOiAvXihHRVswLTldezJ9KVtBLVowLTldezJ9XFxkezE2fSQvLFxuICBHSTogL14oR0lbMC05XXsyfSlbQS1aXXs0fVtBLVowLTldezE1fSQvLFxuICBHTDogL14oR0xbMC05XXsyfSlcXGR7MTR9JC8sXG4gIEdSOiAvXihHUlswLTldezJ9KVxcZHs3fVtBLVowLTldezE2fSQvLFxuICBHVDogL14oR1RbMC05XXsyfSlbQS1aMC05XXs0fVtBLVowLTldezIwfSQvLFxuICBIUjogL14oSFJbMC05XXsyfSlcXGR7MTd9JC8sXG4gIEhVOiAvXihIVVswLTldezJ9KVxcZHsyNH0kLyxcbiAgSUU6IC9eKElFWzAtOV17Mn0pW0EtWjAtOV17NH1cXGR7MTR9JC8sXG4gIElMOiAvXihJTFswLTldezJ9KVxcZHsxOX0kLyxcbiAgSVE6IC9eKElRWzAtOV17Mn0pW0EtWl17NH1cXGR7MTV9JC8sXG4gIElTOiAvXihJU1swLTldezJ9KVxcZHsyMn0kLyxcbiAgSVQ6IC9eKElUWzAtOV17Mn0pW0EtWl17MX1cXGR7MTB9W0EtWjAtOV17MTJ9JC8sXG4gIEpPOiAvXihKT1swLTldezJ9KVtBLVpdezR9XFxkezIyfSQvLFxuICBLVzogL14oS1dbMC05XXsyfSlbQS1aXXs0fVtBLVowLTldezIyfSQvLFxuICBLWjogL14oS1pbMC05XXsyfSlcXGR7M31bQS1aMC05XXsxM30kLyxcbiAgTEI6IC9eKExCWzAtOV17Mn0pXFxkezR9W0EtWjAtOV17MjB9JC8sXG4gIExDOiAvXihMQ1swLTldezJ9KVtBLVpdezR9W0EtWjAtOV17MjR9JC8sXG4gIExJOiAvXihMSVswLTldezJ9KVxcZHs1fVtBLVowLTldezEyfSQvLFxuICBMVDogL14oTFRbMC05XXsyfSlcXGR7MTZ9JC8sXG4gIExVOiAvXihMVVswLTldezJ9KVxcZHszfVtBLVowLTldezEzfSQvLFxuICBMVjogL14oTFZbMC05XXsyfSlbQS1aXXs0fVtBLVowLTldezEzfSQvLFxuICBNQzogL14oTUNbMC05XXsyfSlcXGR7MTB9W0EtWjAtOV17MTF9XFxkezJ9JC8sXG4gIE1EOiAvXihNRFswLTldezJ9KVtBLVowLTldezIwfSQvLFxuICBNRTogL14oTUVbMC05XXsyfSlcXGR7MTh9JC8sXG4gIE1LOiAvXihNS1swLTldezJ9KVxcZHszfVtBLVowLTldezEwfVxcZHsyfSQvLFxuICBNUjogL14oTVJbMC05XXsyfSlcXGR7MjN9JC8sXG4gIE1UOiAvXihNVFswLTldezJ9KVtBLVpdezR9XFxkezV9W0EtWjAtOV17MTh9JC8sXG4gIE1VOiAvXihNVVswLTldezJ9KVtBLVpdezR9XFxkezE5fVtBLVpdezN9JC8sXG4gIE5MOiAvXihOTFswLTldezJ9KVtBLVpdezR9XFxkezEwfSQvLFxuICBOTzogL14oTk9bMC05XXsyfSlcXGR7MTF9JC8sXG4gIFBLOiAvXihQS1swLTldezJ9KVtBLVowLTldezR9XFxkezE2fSQvLFxuICBQTDogL14oUExbMC05XXsyfSlcXGR7MjR9JC8sXG4gIFBTOiAvXihQU1swLTldezJ9KVtBLVowLTldezR9XFxkezIxfSQvLFxuICBQVDogL14oUFRbMC05XXsyfSlcXGR7MjF9JC8sXG4gIFFBOiAvXihRQVswLTldezJ9KVtBLVpdezR9W0EtWjAtOV17MjF9JC8sXG4gIFJPOiAvXihST1swLTldezJ9KVtBLVpdezR9W0EtWjAtOV17MTZ9JC8sXG4gIFJTOiAvXihSU1swLTldezJ9KVxcZHsxOH0kLyxcbiAgU0E6IC9eKFNBWzAtOV17Mn0pXFxkezJ9W0EtWjAtOV17MTh9JC8sXG4gIFNDOiAvXihTQ1swLTldezJ9KVtBLVpdezR9XFxkezIwfVtBLVpdezN9JC8sXG4gIFNFOiAvXihTRVswLTldezJ9KVxcZHsyMH0kLyxcbiAgU0k6IC9eKFNJWzAtOV17Mn0pXFxkezE1fSQvLFxuICBTSzogL14oU0tbMC05XXsyfSlcXGR7MjB9JC8sXG4gIFNNOiAvXihTTVswLTldezJ9KVtBLVpdezF9XFxkezEwfVtBLVowLTldezEyfSQvLFxuICBUTDogL14oVExbMC05XXsyfSlcXGR7MTl9JC8sXG4gIFROOiAvXihUTlswLTldezJ9KVxcZHsyMH0kLyxcbiAgVFI6IC9eKFRSWzAtOV17Mn0pXFxkezV9W0EtWjAtOV17MTd9JC8sXG4gIFVBOiAvXihVQVswLTldezJ9KVxcZHs2fVtBLVowLTldezE5fSQvLFxuICBWQTogL14oVkFbMC05XXsyfSlcXGR7MTh9JC8sXG4gIFZHOiAvXihWR1swLTldezJ9KVtBLVowLTldezR9XFxkezE2fSQvLFxuICBYSzogL14oWEtbMC05XXsyfSlcXGR7MTZ9JC8sXG59O1xuXG4vKipcbiAqIENoZWNrIHdoZXRoZXIgc3RyaW5nIGhhcyBjb3JyZWN0IHVuaXZlcnNhbCBJQkFOIGZvcm1hdFxuICogVGhlIElCQU4gY29uc2lzdHMgb2YgdXAgdG8gMzQgYWxwaGFudW1lcmljIGNoYXJhY3RlcnMsIGFzIGZvbGxvd3M6XG4gKiBDb3VudHJ5IENvZGUgdXNpbmcgSVNPIDMxNjYtMSBhbHBoYS0yLCB0d28gbGV0dGVyc1xuICogY2hlY2sgZGlnaXRzLCB0d28gZGlnaXRzIGFuZFxuICogQmFzaWMgQmFuayBBY2NvdW50IE51bWJlciAoQkJBTiksIHVwIHRvIDMwIGFscGhhbnVtZXJpYyBjaGFyYWN0ZXJzLlxuICogTk9URTogUGVybWl0dGVkIElCQU4gY2hhcmFjdGVycyBhcmU6IGRpZ2l0cyBbMC05XSBhbmQgdGhlIDI2IGxhdGluIGFscGhhYmV0aWMgW0EtWl1cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIC0gc3RyaW5nIHVuZGVyIHZhbGlkYXRpb25cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGhhc1ZhbGlkSWJhbkZvcm1hdChzdHIpIHtcbiAgLy8gU3RyaXAgd2hpdGUgc3BhY2VzIGFuZCBoeXBoZW5zLCBrZWVwIG9ubHkgZGlnaXRzIGFuZCBBLVogbGF0aW4gYWxwaGFiZXRpY1xuICBjb25zdCBzdHJpcHBlZFN0ciA9IHN0ci5yZXBsYWNlKC9bXkEtWjAtOV0rL2dpLCAnJykudG9VcHBlckNhc2UoKTtcbiAgY29uc3QgaXNvQ291bnRyeUNvZGUgPSBzdHJpcHBlZFN0ci5zbGljZSgwLCAyKS50b1VwcGVyQ2FzZSgpO1xuXG4gIHJldHVybiAoaXNvQ291bnRyeUNvZGUgaW4gaWJhblJlZ2V4VGhyb3VnaENvdW50cnlDb2RlKSAmJlxuICAgIGliYW5SZWdleFRocm91Z2hDb3VudHJ5Q29kZVtpc29Db3VudHJ5Q29kZV0udGVzdChzdHJpcHBlZFN0cik7XG59XG5cbi8qKlxuICAgKiBDaGVjayB3aGV0aGVyIHN0cmluZyBoYXMgdmFsaWQgSUJBTiBDaGVja3N1bVxuICAgKiBieSBwZXJmb3JtaW5nIGJhc2ljIG1vZC05NyBvcGVyYXRpb24gYW5kXG4gICAqIHRoZSByZW1haW5kZXIgc2hvdWxkIGVxdWFsIDFcbiAgICogLS0gU3RhcnQgYnkgcmVhcnJhbmdpbmcgdGhlIElCQU4gYnkgbW92aW5nIHRoZSBmb3VyIGluaXRpYWwgY2hhcmFjdGVycyB0byB0aGUgZW5kIG9mIHRoZSBzdHJpbmdcbiAgICogLS0gUmVwbGFjZSBlYWNoIGxldHRlciBpbiB0aGUgc3RyaW5nIHdpdGggdHdvIGRpZ2l0cywgQSAtPiAxMCwgQiA9IDExLCBaID0gMzVcbiAgICogLS0gSW50ZXJwcmV0IHRoZSBzdHJpbmcgYXMgYSBkZWNpbWFsIGludGVnZXIgYW5kXG4gICAqIC0tIGNvbXB1dGUgdGhlIHJlbWFpbmRlciBvbiBkaXZpc2lvbiBieSA5NyAobW9kIDk3KVxuICAgKiBSZWZlcmVuY2U6IGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0ludGVybmF0aW9uYWxfQmFua19BY2NvdW50X051bWJlclxuICAgKlxuICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgc3RyaW5nXG4gICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgc3RyaW5nIGhhcyBhIHZhbGlkIElCQU4gY2hlY2tzdW0sIGZhbHNlIG90aGVyd2lzZVxuICAgKi9cbmZ1bmN0aW9uIGhhc1ZhbGlkSWJhbkNoZWNrc3VtKHRhcmdldCkge1xuICBjb25zdCBzdHJpcHBlZFN0ciA9IHRhcmdldC5yZXBsYWNlKC9bXkEtWjAtOV0rL2dpLCAnJykudG9VcHBlckNhc2UoKTsgLy8gS2VlcCBvbmx5IGRpZ2l0cyBhbmQgQS1aIGxhdGluIGFscGhhYmV0aWNcbiAgY29uc3QgcmVhcnJhbmdlZCA9IHN0cmlwcGVkU3RyLnNsaWNlKDQpICsgc3RyaXBwZWRTdHIuc2xpY2UoMCwgNCk7XG4gIGNvbnN0IGFscGhhQ2Fwc1JlcGxhY2VkV2l0aERpZ2l0cyA9IHJlYXJyYW5nZWQucmVwbGFjZSgvW0EtWl0vZywgY2hhciA9PiBjaGFyLmNoYXJDb2RlQXQoMCkgLSA1NSk7XG5cbiAgY29uc3QgcmVtYWluZGVyID0gYWxwaGFDYXBzUmVwbGFjZWRXaXRoRGlnaXRzLm1hdGNoKC9cXGR7MSw3fS9nKVxuICAgIC5yZWR1Y2UoKGFjYywgdmFsdWUpID0+IE51bWJlcihhY2MgKyB2YWx1ZSkgJSA5NywgJycpO1xuXG4gIHJldHVybiByZW1haW5kZXIgPT09IDE7XG59XG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSBJQkFOIG51bWJlciBoYXMgYSB2YWxpZCBmb3JtYXQgYW5kIGNoZWNrc3VtLlxuICogXG4gKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgc3RyaW5nXG4gKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRhcmdldCBoYXMgYSB2YWxpZCBmb3JtYXQgYW5kIGNoZWNrc3VtLCBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSUJBTih0YXJnZXQ6IHN0cmluZykge1xuICBhc3NlcnRTdHJpbmcodGFyZ2V0KTtcblxuICByZXR1cm4gaGFzVmFsaWRJYmFuRm9ybWF0KHRhcmdldCkgJiYgaGFzVmFsaWRJYmFuQ2hlY2tzdW0odGFyZ2V0KTtcbn1cbiJdfQ==